{"ast":null,"code":"import { getVideo, getStream } from '@/services/videoApi';\nimport { getStats } from '@/services/peerApi';\nimport StatusBar from '@/components/StatusBar.vue';\nexport default {\n  name: 'VideoPage',\n  components: {\n    StatusBar\n  },\n  data() {\n    return {\n      video: null,\n      stream: null,\n      stats: {},\n      timer: null,\n      playing: false,\n      currentTime: 0,\n      duration: 0\n    };\n  },\n  async mounted() {\n    const rid = this.$route.query.rid;\n    this.video = await getVideo(rid);\n    this.stream = await getStream(rid);\n    const el = this.$refs.player;\n    el.src = this.stream.url;\n    el.addEventListener('loadedmetadata', () => {\n      this.duration = el.duration || this.video.duration;\n    });\n    el.addEventListener('timeupdate', () => {\n      this.currentTime = el.currentTime;\n    });\n    this.timer = setInterval(async () => {\n      this.stats = await getStats();\n    }, 500);\n  },\n  unmounted() {\n    if (this.timer) clearInterval(this.timer);\n  },\n  methods: {\n    togglePlay() {\n      const el = this.$refs.player;\n      if (el.paused) {\n        el.play();\n        this.playing = true;\n      } else {\n        el.pause();\n        this.playing = false;\n      }\n    },\n    seek() {\n      const el = this.$refs.player;\n      el.currentTime = this.currentTime;\n    }\n  }\n};","map":{"version":3,"names":["getVideo","getStream","getStats","StatusBar","name","components","data","video","stream","stats","timer","playing","currentTime","duration","mounted","rid","$route","query","el","$refs","player","src","url","addEventListener","setInterval","unmounted","clearInterval","methods","togglePlay","paused","play","pause","seek"],"sources":["/home/cracken/project/p2p-video-accelerator/viewer/p2p-video-viewer/frontend/src/views/VideoPage.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <div class=\"card\">\n      <div class=\"title\">{{ video?.title || '正在加载...' }}</div>\n      <video ref=\"player\" controls style=\"width:100%; border-radius:8px; background:#000; height: 420px\"></video>\n      <div class=\"controls\">\n        <input type=\"range\" min=\"0\" :max=\"duration\" step=\"0.1\" v-model.number=\"currentTime\" @input=\"seek\" />\n        <div class=\"bottom\">\n          <button class=\"btn\" @click=\"togglePlay\">{{ playing ? '暂停' : '播放' }}</button>\n          <StatusBar :stats=\"stats\" />\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { getVideo, getStream } from '@/services/videoApi'\nimport { getStats } from '@/services/peerApi'\nimport StatusBar from '@/components/StatusBar.vue'\n\nexport default {\n  name: 'VideoPage',\n  components: { StatusBar },\n  data(){\n    return { video: null, stream: null, stats: {}, timer: null, playing: false, currentTime: 0, duration: 0 }\n  },\n  async mounted(){\n    const rid = this.$route.query.rid\n    this.video = await getVideo(rid)\n    this.stream = await getStream(rid)\n    const el = this.$refs.player\n    el.src = this.stream.url\n    el.addEventListener('loadedmetadata', () => { this.duration = el.duration || this.video.duration })\n    el.addEventListener('timeupdate', () => { this.currentTime = el.currentTime })\n    this.timer = setInterval(async () => { this.stats = await getStats() }, 500)\n  },\n  unmounted(){ if (this.timer) clearInterval(this.timer) },\n  methods: {\n    togglePlay(){ const el = this.$refs.player; if (el.paused) { el.play(); this.playing = true } else { el.pause(); this.playing = false } },\n    seek(){ const el = this.$refs.player; el.currentTime = this.currentTime }\n  }\n}\n</script>\n\n<style scoped>\n.title { font-weight: bold; font-size: 18px; margin-bottom: 12px; }\n.controls { margin-top: 12px; }\n.controls .bottom { display: flex; justify-content: space-between; align-items: center; margin-top: 8px; }\ninput[type=range]{ width: 100%; }\n</style>\n"],"mappings":"AAiBA,SAASA,QAAQ,EAAEC,SAAQ,QAAS,qBAAoB;AACxD,SAASC,QAAO,QAAS,oBAAmB;AAC5C,OAAOC,SAAQ,MAAO,4BAA2B;AAEjD,eAAe;EACbC,IAAI,EAAE,WAAW;EACjBC,UAAU,EAAE;IAAEF;EAAU,CAAC;EACzBG,IAAIA,CAAA,EAAE;IACJ,OAAO;MAAEC,KAAK,EAAE,IAAI;MAAEC,MAAM,EAAE,IAAI;MAAEC,KAAK,EAAE,CAAC,CAAC;MAAEC,KAAK,EAAE,IAAI;MAAEC,OAAO,EAAE,KAAK;MAAEC,WAAW,EAAE,CAAC;MAAEC,QAAQ,EAAE;IAAE;EAC1G,CAAC;EACD,MAAMC,OAAOA,CAAA,EAAE;IACb,MAAMC,GAAE,GAAI,IAAI,CAACC,MAAM,CAACC,KAAK,CAACF,GAAE;IAChC,IAAI,CAACR,KAAI,GAAI,MAAMP,QAAQ,CAACe,GAAG;IAC/B,IAAI,CAACP,MAAK,GAAI,MAAMP,SAAS,CAACc,GAAG;IACjC,MAAMG,EAAC,GAAI,IAAI,CAACC,KAAK,CAACC,MAAK;IAC3BF,EAAE,CAACG,GAAE,GAAI,IAAI,CAACb,MAAM,CAACc,GAAE;IACvBJ,EAAE,CAACK,gBAAgB,CAAC,gBAAgB,EAAE,MAAM;MAAE,IAAI,CAACV,QAAO,GAAIK,EAAE,CAACL,QAAO,IAAK,IAAI,CAACN,KAAK,CAACM,QAAO;IAAE,CAAC;IAClGK,EAAE,CAACK,gBAAgB,CAAC,YAAY,EAAE,MAAM;MAAE,IAAI,CAACX,WAAU,GAAIM,EAAE,CAACN,WAAU;IAAE,CAAC;IAC7E,IAAI,CAACF,KAAI,GAAIc,WAAW,CAAC,YAAY;MAAE,IAAI,CAACf,KAAI,GAAI,MAAMP,QAAQ,CAAC;IAAE,CAAC,EAAE,GAAG;EAC7E,CAAC;EACDuB,SAASA,CAAA,EAAE;IAAE,IAAI,IAAI,CAACf,KAAK,EAAEgB,aAAa,CAAC,IAAI,CAAChB,KAAK;EAAE,CAAC;EACxDiB,OAAO,EAAE;IACPC,UAAUA,CAAA,EAAE;MAAE,MAAMV,EAAC,GAAI,IAAI,CAACC,KAAK,CAACC,MAAM;MAAE,IAAIF,EAAE,CAACW,MAAM,EAAE;QAAEX,EAAE,CAACY,IAAI,CAAC,CAAC;QAAE,IAAI,CAACnB,OAAM,GAAI,IAAG;MAAE,OAAO;QAAEO,EAAE,CAACa,KAAK,CAAC,CAAC;QAAE,IAAI,CAACpB,OAAM,GAAI,KAAI;MAAE;IAAE,CAAC;IACzIqB,IAAIA,CAAA,EAAE;MAAE,MAAMd,EAAC,GAAI,IAAI,CAACC,KAAK,CAACC,MAAM;MAAEF,EAAE,CAACN,WAAU,GAAI,IAAI,CAACA,WAAU;IAAE;EAC1E;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}